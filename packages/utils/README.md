shared utility function - basically pure function here